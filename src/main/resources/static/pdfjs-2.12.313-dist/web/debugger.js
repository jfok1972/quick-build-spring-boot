"use strict";var FontInspector=function(){let e,t=!1;const n="data-font-name";function a(){const e=document.querySelectorAll(`span[${n}]`);for(const t of e)t.className=""}function o(){const e=document.querySelectorAll(`span[${n}]`);for(const t of e)t.className="debuggerHideText"}function i(e,t){const a=document.querySelectorAll(`span[${n}=${e}]`);for(const n of a)n.className=t?"debuggerShowText":"debuggerHideText"}function s(e){if(!e.target.dataset.fontName||"SPAN"!==e.target.tagName.toUpperCase())return;const t=e.target.dataset.fontName,n=document.getElementsByTagName("input");for(let a=0;a<n.length;++a){const e=n[a];e.dataset.fontName===t&&(e.checked=!e.checked,i(t,e.checked),e.scrollIntoView())}}return{id:"FontInspector",name:"Font Inspector",panel:null,manager:null,init:function(t){const n=this.panel,a=document.createElement("button");a.addEventListener("click",o),a.textContent="Refresh",n.appendChild(a),e=document.createElement("div"),n.appendChild(e)},cleanup:function(){e.textContent=""},enabled:!1,get active(){return t},set active(e){t=e,t?(document.body.addEventListener("click",s,!0),o()):(document.body.removeEventListener("click",s,!0),a())},fontAdded:function(t,n){function a(e,t){const n=document.createElement("table");for(let a=0;a<t.length;a++){const o=document.createElement("tr"),i=document.createElement("td");i.textContent=t[a],o.appendChild(i);const s=document.createElement("td");s.textContent=e[t[a]].toString(),o.appendChild(s),n.appendChild(o)}return n}const s=a(t,["name","type"]),d=t.loadedName,l=document.createElement("div"),r=document.createElement("span");r.textContent=d;const c=document.createElement("a");n?(n=/url\(['"]?([^)"']+)/.exec(n),c.href=n[1]):t.data&&(c.href=URL.createObjectURL(new Blob([t.data],{type:t.mimeType}))),c.textContent="Download";const p=document.createElement("a");p.href="",p.textContent="Log",p.addEventListener("click",(function(e){e.preventDefault(),console.log(t)}));const h=document.createElement("input");h.setAttribute("type","checkbox"),h.dataset.fontName=d,h.addEventListener("click",(function(){i(d,h.checked)})),l.appendChild(h),l.appendChild(r),l.appendChild(document.createTextNode(" ")),l.appendChild(c),l.appendChild(document.createTextNode(" ")),l.appendChild(p),l.appendChild(s),e.appendChild(l),setTimeout((()=>{this.active&&o()}),2e3)}}}();let opMap;var StepperManager=function(){let e=[],t=null,n=null,a=null,o=Object.create(null);return{id:"Stepper",name:"Stepper",panel:null,manager:null,init:function(e){const i=this;n=document.createElement("div"),a=document.createElement("select"),a.addEventListener("change",(function(e){i.selectStepper(this.value)})),n.appendChild(a),t=document.createElement("div"),this.panel.appendChild(n),this.panel.appendChild(t),sessionStorage.getItem("pdfjsBreakPoints")&&(o=JSON.parse(sessionStorage.getItem("pdfjsBreakPoints"))),opMap=Object.create(null);for(const t in e.OPS)opMap[e.OPS[t]]=t},cleanup:function(){a.textContent="",t.textContent="",e=[]},enabled:!1,active:!1,create:function(n){const i=document.createElement("div");i.id="stepper"+n,i.hidden=!0,i.className="stepper",t.appendChild(i);const s=document.createElement("option");s.textContent="Page "+(n+1),s.value=n,a.appendChild(s);const d=o[n]||[],l=new Stepper(i,n,d);return e.push(l),1===e.length&&this.selectStepper(n,!1),l},selectStepper:function(t,n){let o;for(t|=0,n&&this.manager.selectPanel(this),o=0;o<e.length;++o){const n=e[o];n.panel.hidden=n.pageIndex!==t}const i=a.options;for(o=0;o<i.length;++o){const e=i[o];e.selected=(0|e.value)===t}},saveBreakPoints:function(e,t){o[e]=t,sessionStorage.setItem("pdfjsBreakPoints",JSON.stringify(o))}}}();const Stepper=function(){function e(e,t){const n=document.createElement(e);return t&&(n.textContent=t),n}function t(e){if("string"===typeof e){const t=75;return e.length<=t?e:e.substring(0,t)+"..."}if("object"!==typeof e||null===e)return e;if("length"in e){const n=10,a=[];let o,i;for(o=0,i=Math.min(n,e.length);o<i;o++)a.push(t(e[o]));return o<e.length&&a.push("..."),a}const n={};for(const a in e)n[a]=t(e[a]);return n}class n{constructor(e,t,n){this.panel=e,this.breakPoint=0,this.nextBreakPoint=null,this.pageIndex=t,this.breakPoints=n,this.currentIdx=-1,this.operatorListIdx=0,this.indentLevel=0}init(t){const n=this.panel,a=e("div","c=continue, s=step"),o=e("table");a.appendChild(o),o.cellSpacing=0;const i=e("tr");o.appendChild(i),i.appendChild(e("th","Break")),i.appendChild(e("th","Idx")),i.appendChild(e("th","fn")),i.appendChild(e("th","args")),n.appendChild(a),this.table=o,this.updateOperatorList(t)}updateOperatorList(n){const a=this;function o(){const e=+this.dataset.idx;this.checked?a.breakPoints.push(e):a.breakPoints.splice(a.breakPoints.indexOf(e),1),StepperManager.saveBreakPoints(a.pageIndex,a.breakPoints)}const i=15e3;if(this.operatorListIdx>i)return;const s=document.createDocumentFragment(),d=Math.min(i,n.fnArray.length);for(let l=this.operatorListIdx;l<d;l++){const a=e("tr");a.className="line",a.dataset.idx=l,s.appendChild(a);const i=this.breakPoints.includes(l),d=n.argsArray[l]||[],r=e("td"),c=e("input");c.type="checkbox",c.className="points",c.checked=i,c.dataset.idx=l,c.onclick=o,r.appendChild(c),a.appendChild(r),a.appendChild(e("td",l.toString()));const p=opMap[n.fnArray[l]];let h=d;if("showText"===p){const t=d[0],n=e("tr"),a=e("tr"),o=e("tr");for(let s=0;s<t.length;s++){const i=t[s];if("object"===typeof i&&null!==i)n.appendChild(e("td",i.originalCharCode)),a.appendChild(e("td",i.fontChar)),o.appendChild(e("td",i.unicode));else{const t=e("td",i);t.classList.add("advance"),n.appendChild(t),a.appendChild(e("td")),o.appendChild(e("td"))}}h=e("td");const i=e("table");i.classList.add("showText"),h.appendChild(i),i.appendChild(n),i.appendChild(a),i.appendChild(o)}else"restore"===p&&this.indentLevel--;a.appendChild(e("td"," ".repeat(2*this.indentLevel)+p)),"save"===p&&this.indentLevel++,h instanceof HTMLElement?a.appendChild(h):a.appendChild(e("td",JSON.stringify(t(h))))}if(d<n.fnArray.length){const t=e("td","...");t.colspan=4,s.appendChild(t)}this.operatorListIdx=n.fnArray.length,this.table.appendChild(s)}getNextBreakPoint(){this.breakPoints.sort((function(e,t){return e-t}));for(let e=0;e<this.breakPoints.length;e++)if(this.breakPoints[e]>this.currentIdx)return this.breakPoints[e];return null}breakIt(e,t){StepperManager.selectStepper(this.pageIndex,!0),this.currentIdx=e;const n=e=>{switch(e.keyCode){case 83:document.removeEventListener("keydown",n),this.nextBreakPoint=this.currentIdx+1,this.goTo(-1),t();break;case 67:document.removeEventListener("keydown",n),this.nextBreakPoint=this.getNextBreakPoint(),this.goTo(-1),t();break}};document.addEventListener("keydown",n),this.goTo(e)}goTo(e){const t=this.panel.getElementsByClassName("line");for(let n=0,a=t.length;n<a;++n){const a=t[n];(0|a.dataset.idx)===e?(a.style.backgroundColor="rgb(251,250,207)",a.scrollIntoView()):a.style.backgroundColor=null}}}return n}();var Stats=function(){let e=[];function t(e){e.textContent=""}function n(t){for(let n=0,a=e.length;n<a;++n)if(e[n].pageNumber===t)return n;return!1}return{id:"Stats",name:"Stats",panel:null,manager:null,init(e){},enabled:!1,active:!1,add(a,o){if(!o)return;const i=n(a);!1!==i&&(e[i].div.remove(),e.splice(i,1));const s=document.createElement("div");s.className="stats";const d=document.createElement("div");d.className="title",d.textContent="Page: "+a;const l=document.createElement("div");l.textContent=o.toString(),s.appendChild(d),s.appendChild(l),e.push({pageNumber:a,div:s}),e.sort((function(e,t){return e.pageNumber-t.pageNumber})),t(this.panel);for(let t=0,n=e.length;t<n;++t)this.panel.appendChild(e[t].div)},cleanup(){e=[],t(this.panel)}}}();window.PDFBug=function(){const e=300,t=[];let n=null;return{tools:[FontInspector,StepperManager,Stats],enable(e){const t=1===e.length&&"all"===e[0],n=this.tools;for(let a=0;a<n.length;++a){const o=n[a];(t||e.includes(o.id))&&(o.enabled=!0)}t||n.sort((function(t,a){let o=e.indexOf(t.id);o=o<0?n.length:o;let i=e.indexOf(a.id);return i=i<0?n.length:i,o-i}))},init(n,a,o){this.enable(o);const i=document.createElement("div");i.id="PDFBug";const s=document.createElement("div");s.setAttribute("class","controls"),i.appendChild(s);const d=document.createElement("div");d.setAttribute("class","panels"),i.appendChild(d),a.appendChild(i),a.style.right=e+"px";const l=this.tools,r=this;for(let e=0;e<l.length;++e){const a=l[e],o=document.createElement("div"),i=document.createElement("button");i.textContent=a.name,i.addEventListener("click",function(e){return function(t){t.preventDefault(),r.selectPanel(e)}}(e)),s.appendChild(i),d.appendChild(o),a.panel=o,a.manager=this,a.enabled?a.init(n):o.textContent=`${a.name} is disabled. To enable add "${a.id}" to the pdfBug parameter and refresh (separate multiple by commas).`,t.push(i)}this.selectPanel(0)},cleanup(){for(let e=0,t=this.tools.length;e<t;e++)this.tools[e].enabled&&this.tools[e].cleanup()},selectPanel(e){if("number"!==typeof e&&(e=this.tools.indexOf(e)),e===n)return;n=e;const a=this.tools;for(let n=0;n<a.length;++n){const o=n===e;t[n].classList.toggle("active",o),a[n].active=o,a[n].panel.hidden=!o}}}}();